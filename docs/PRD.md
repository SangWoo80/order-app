# 커피 주문 앱

## 1. 프로젝트 개요

### 1.1 프로젝트명
커피 주문 앱

### 1.2 프로젝트 목적
사용자가 커피 메뉴를 주문하고, 관리자가 주문을 관리할 수 있는 간단한 풀스택 웹 앱

### 1.3 개발 범위
- 주문하기 화면(메뉴 선택 및 장바구니 기능)
- 관리자 화면(재고 관리 및 주문 상태 관리)
- 데이터를 생성/조회/수정/삭제할 수 있는 기능

## 2. 기술 스택
- 프런트엔드 : HTML, CSS, 리액트, 자바스크립트
- 백엔드 : Node.js, Express
- 데이터베이스 : PostgreSQL

## 3. 기본 사항
- 프런트엔드와 백엔드를 따로 개발
- 기본적인 웹 기술만 사용
- 학습 목적이므로 사용자 인증이나 결제 기능은 제외
- 메뉴는 커피 메뉴만 있음

## 4. 주문하기 화면 (Order Screen)

### 4.1 화면 개요
사용자가 커피 메뉴를 선택하고 장바구니에 담아 주문할 수 있는 메인 화면입니다.

### 4.2 레이아웃 구조
화면은 세 가지 주요 영역으로 구성됩니다:
1. **헤더 영역**: 상단 고정 영역
2. **메뉴 아이템 영역**: 중앙 스크롤 가능 영역
3. **장바구니 영역**: 하단 고정 영역

### 4.3 헤더 영역 (Header)

#### 4.3.1 구성 요소
- **로고 박스**: 왼쪽 상단에 위치
  - 배경색: 다크 그린 (dark green)
  - 텍스트: "COZY" (흰색)
  - 형태: 직사각형 박스

- **주문하기 버튼**: 로고 오른쪽에 위치
  - 텍스트: "주문하기"
  - 기능: 현재 화면 유지 (현재 화면이 주문하기 화면이므로 활성화 상태)

- **관리자 버튼**: 주문하기 버튼 오른쪽에 위치
  - 텍스트: "관리자"
  - 기능: 관리자 화면으로 이동

#### 4.3.2 디자인 요구사항
- 헤더는 화면 상단에 고정
- 깔끔하고 미니멀한 디자인
- 버튼은 클릭 가능한 상태를 명확히 표시

### 4.4 메뉴 아이템 영역 (Menu Items Section)

#### 4.4.1 메뉴 카드 구조
각 메뉴 아이템은 카드 형태로 표시되며, 다음 요소들을 포함합니다:

1. **메뉴 이미지**
   - 위치: 카드 상단
   - 형태: 직사각형 이미지 영역
   - 기본값: 플레이스홀더 이미지 (대각선 교차선이 있는 흰색 박스)
   - 실제 이미지가 없을 경우 플레이스홀더 표시

2. **메뉴 이름**
   - 위치: 이미지 하단
   - 예시: "아메리카노(ICE)", "아메리카노(HOT)", "카페라떼"
   - 텍스트: 진한 회색

3. **가격**
   - 위치: 메뉴 이름 하단
   - 형식: "X,XXX원" (천 단위 구분 쉼표 포함)
   - 예시: "4,000원", "5,000원"

4. **설명**
   - 위치: 가격 하단
   - 텍스트: "간단한 설명..." (기본값)
   - 메뉴에 대한 간단한 설명 표시

5. **커스터마이징 옵션**
   - 위치: 설명 하단
   - 형태: 체크박스 형태의 옵션들
   - 각 옵션은 다음 정보 포함:
     - 옵션 이름
     - 추가 가격 (괄호 안에 표시)
   - 예시 옵션:
     - "샷 추가 (+500원)"
     - "시럽 추가 (+0원)"
   - 사용자는 여러 옵션을 동시에 선택 가능

6. **담기 버튼**
   - 위치: 카드 하단
   - 텍스트: "담기"
   - 배경색: 회색
   - 기능: 선택한 옵션과 함께 해당 메뉴를 장바구니에 추가

#### 4.4.2 레이아웃
- 메뉴 카드들은 가로로 나열 (3개씩 또는 반응형 그리드)
- 카드 간 적절한 간격 유지
- 화면 크기에 따라 반응형으로 조정

#### 4.4.3 동작
- 사용자가 옵션을 선택하고 "담기" 버튼을 클릭하면:
  - 선택한 메뉴와 옵션이 장바구니에 추가됨
  - 기본 가격 + 선택한 옵션의 추가 가격이 합산되어 장바구니에 표시됨
  - 같은 메뉴와 옵션 조합이 이미 장바구니에 있으면 수량이 증가함

### 4.5 장바구니 영역 (Shopping Cart Section)

#### 4.5.1 구성 요소

1. **장바구니 제목**
   - 텍스트: "장바구니"
   - 위치: 장바구니 영역 상단

2. **장바구니 아이템 목록**
   - 위치: 제목 하단, 왼쪽 영역
   - 각 아이템은 다음 정보를 표시:
     - 메뉴 이름
     - 선택한 옵션 (있는 경우): 괄호 안에 표시
       - 예시: "아메리카노(ICE) (샷 추가)"
     - 수량: "X N" 형식
       - 예시: "X 1", "X 2"
     - 가격: "X,XXX원" 형식
       - 예시: "4,500원", "8,000원"
   - 각 아이템은 한 줄로 표시

3. **총 금액**
   - 위치: 아이템 목록 오른쪽
   - 레이블: "총 금액"
   - 금액: 굵은 글씨로 표시
   - 형식: "XX,XXX원" (천 단위 구분 쉼표 포함)
   - 계산: 모든 장바구니 아이템의 가격 합계

4. **주문하기 버튼**
   - 위치: 총 금액 하단
   - 텍스트: "주문하기"
   - 배경색: 회색
   - 기능: 장바구니의 모든 아이템을 주문으로 제출

#### 4.5.2 레이아웃
- 장바구니 영역은 화면 하단에 고정
- 아이템 목록과 총 금액은 좌우로 배치
- 장바구니가 비어있을 경우 적절한 안내 메시지 표시

#### 4.5.3 동작
- 장바구니에 아이템이 추가되면:
  - 해당 아이템이 목록에 표시됨
  - 총 금액이 자동으로 업데이트됨
- 같은 메뉴와 옵션 조합이 추가되면:
  - 기존 아이템의 수량이 증가함
  - 가격도 수량에 맞게 업데이트됨
- 주문하기 버튼 클릭 시:
  - 장바구니의 모든 아이템이 주문으로 제출됨
  - 주문 완료 후 장바구니가 비워짐
  - 주문 완료 알림 표시 (선택 사항)

### 4.6 UI/UX 요구사항

#### 4.6.1 디자인 스타일
- 전체적으로 깔끔하고 미니멀한 디자인
- 배경: 흰색
- 텍스트: 진한 회색
- 강조 색상: 다크 그린 (로고에 사용)
- 버튼: 회색 배경

#### 4.6.2 사용자 경험
- 직관적인 인터페이스로 사용자가 쉽게 메뉴를 선택하고 주문할 수 있어야 함
- 장바구니에 추가된 아이템이 즉시 반영되어야 함
- 총 금액이 실시간으로 업데이트되어야 함
- 버튼 클릭 시 명확한 피드백 제공

#### 4.6.3 반응형 디자인
- 다양한 화면 크기에 대응 가능한 반응형 레이아웃
- 모바일, 태블릿, 데스크톱 환경 모두 지원

### 4.7 데이터 요구사항

#### 4.7.1 메뉴 데이터 구조
각 메뉴 아이템은 다음 정보를 포함해야 합니다:
- 메뉴 ID
- 메뉴 이름
- 기본 가격
- 설명
- 이미지 URL (선택 사항)
- 사용 가능한 옵션 목록:
  - 옵션 이름
  - 추가 가격

#### 4.7.2 장바구니 데이터 구조
장바구니 아이템은 다음 정보를 포함해야 합니다:
- 메뉴 ID
- 메뉴 이름
- 선택한 옵션 목록
- 수량
- 단가 (기본 가격 + 옵션 추가 가격)
- 총 가격 (단가 × 수량)

## 5. 관리자 화면 (Admin Screen)

### 5.1 화면 개요
관리자가 주문을 관리하고 재고를 조정할 수 있는 관리자 전용 화면입니다.

### 5.2 레이아웃 구조
화면은 네 가지 주요 영역으로 구성됩니다:
1. **헤더 영역**: 상단 고정 영역
2. **관리자 대시보드 영역**: 주문 통계 요약
3. **재고 현황 영역**: 메뉴별 재고 관리
4. **주문 현황 영역**: 주문 목록 및 상태 관리

### 5.3 헤더 영역 (Header)

#### 5.3.1 구성 요소
- **로고 박스**: 왼쪽 상단에 위치
  - 배경색: 다크 그린 (dark green)
  - 텍스트: "COZY" (흰색)
  - 형태: 직사각형 박스

- **주문하기 버튼**: 로고 오른쪽에 위치
  - 텍스트: "주문하기"
  - 기능: 주문하기 화면으로 이동

- **관리자 버튼**: 주문하기 버튼 오른쪽에 위치
  - 텍스트: "관리자"
  - 기능: 현재 화면 유지 (현재 화면이 관리자 화면이므로 활성화 상태)
  - 활성화 표시: 진한 테두리로 현재 화면임을 표시

#### 5.3.2 디자인 요구사항
- 헤더는 화면 상단에 고정
- 현재 활성화된 화면 버튼은 진한 테두리로 구분
- 주문하기 화면과 동일한 헤더 디자인 유지

### 5.4 관리자 대시보드 영역 (Admin Dashboard Section)

#### 5.4.1 구성 요소
- **섹션 컨테이너**
  - 배경색: 연한 회색 (light grey)
  - 형태: 둥근 모서리를 가진 직사각형 박스
  - 섹션 간 적절한 간격 유지

- **섹션 제목**
  - 텍스트: "관리자 대시보드"
  - 위치: 섹션 상단

- **주문 통계 요약**
  - 위치: 제목 하단
  - 형식: 한 줄 텍스트로 표시
  - 표시 정보:
    - 총 주문 수
    - 주문 접수 수
    - 제조 중 수
    - 제조 완료 수
  - 예시: "총 주문 1 / 주문 접수 1 / 제조 중 0 / 제조 완료 0"
  - 구분자: " / " (슬래시와 공백)

#### 5.4.2 동작
- 주문 상태가 변경될 때마다 통계가 실시간으로 업데이트됨
- 각 상태별 주문 수는 자동으로 계산되어 표시됨

### 5.5 재고 현황 영역 (Inventory Status Section)

#### 5.5.1 구성 요소
- **섹션 컨테이너**
  - 배경색: 연한 회색 (light grey)
  - 형태: 둥근 모서리를 가진 직사각형 박스

- **섹션 제목**
  - 텍스트: "재고 현황"
  - 위치: 섹션 상단

- **재고 카드**
  - 각 메뉴 아이템마다 하나의 카드 표시
  - 카드들은 가로로 나열
  - 각 카드 구성:
    1. **메뉴 이름**
       - 위치: 카드 상단
       - 예시: "아메리카노 (ICE)", "아메리카노 (HOT)", "카페라떼"
    
    2. **재고 수량**
       - 위치: 메뉴 이름 하단
       - 형식: "XX개"
       - 예시: "10개"
       - 텍스트: 굵은 글씨 또는 강조 표시
    
    3. **재고 조정 버튼**
       - 위치: 수량 하단
       - 버튼 구성:
         - **증가 버튼**: "+" 기호
         - **감소 버튼**: "-" 기호
       - 버튼 크기: 작은 크기
       - 버튼 배치: 가로로 나란히 배치

#### 5.5.2 레이아웃
- 재고 카드들은 가로로 나열 (3개씩 또는 반응형 그리드)
- 카드 간 적절한 간격 유지
- 화면 크기에 따라 반응형으로 조정

#### 5.5.3 동작
- **증가 버튼 (+) 클릭 시**:
  - 해당 메뉴의 재고 수량이 1 증가
  - 변경 사항이 즉시 화면에 반영
  - 데이터베이스에 저장

- **감소 버튼 (-) 클릭 시**:
  - 해당 메뉴의 재고 수량이 1 감소
  - 재고가 0 이하로 내려가지 않도록 제한 (선택 사항)
  - 변경 사항이 즉시 화면에 반영
  - 데이터베이스에 저장

- 재고 변경 시 실시간으로 화면 업데이트

### 5.6 주문 현황 영역 (Order Status Section)

#### 5.6.1 구성 요소
- **섹션 컨테이너**
  - 배경색: 연한 회색 (light grey)
  - 형태: 둥근 모서리를 가진 직사각형 박스
  - 위치: 화면 하단

- **섹션 제목**
  - 텍스트: "주문 현황"
  - 위치: 섹션 상단

- **주문 목록**
  - 위치: 제목 하단
  - 각 주문은 하나의 항목으로 표시
  - 주문 항목 구성:
    1. **주문 시간**
       - 형식: "X월 XX일 XX:XX"
       - 예시: "7월 31일 13:00"
       - 위치: 주문 항목 상단 또는 왼쪽
    
    2. **주문 내용**
       - 메뉴 이름과 수량 표시
       - 형식: "메뉴이름 x 수량"
       - 예시: "아메리카노(ICE) x 1"
       - 선택한 옵션이 있는 경우 옵션 정보도 표시 (선택 사항)
    
    3. **주문 금액**
       - 형식: "X,XXX원" (천 단위 구분 쉼표 포함)
       - 예시: "4,000원"
       - 위치: 주문 내용 옆 또는 아래
    
    4. **주문 상태 버튼**
       - 버튼 텍스트는 주문 상태에 따라 변경됨
       - 상태별 버튼:
         - **"주문 접수"**: 주문이 접수 대기 중일 때
         - **"제조 중"**: 주문이 접수되어 제조 중일 때
         - **"제조 완료"**: 제조가 완료되었을 때
       - 위치: 주문 항목 오른쪽 또는 하단

#### 5.6.2 레이아웃
- 주문 목록은 세로로 나열
- 각 주문 항목은 명확하게 구분되어 표시
- 주문이 많을 경우 스크롤 가능
- 주문 항목 간 적절한 간격 유지

#### 5.6.3 동작
- **"주문 접수" 버튼 클릭 시**:
  - 주문 상태가 "주문 접수"로 변경됨
  - 버튼 텍스트가 "제조 중"으로 변경됨
  - 관리자 대시보드의 통계가 업데이트됨
  - 해당 메뉴의 재고가 자동으로 차감됨 (선택 사항)

- **"제조 중" 버튼 클릭 시**:
  - 주문 상태가 "제조 중"으로 변경됨
  - 버튼 텍스트가 "제조 완료"로 변경됨
  - 관리자 대시보드의 통계가 업데이트됨

- **"제조 완료" 버튼 클릭 시**:
  - 주문 상태가 "제조 완료"로 변경됨
  - 주문 항목이 목록에서 제거되거나 완료 표시됨 (선택 사항)
  - 관리자 대시보드의 통계가 업데이트됨

- 주문 상태 변경 시 실시간으로 화면 업데이트
- 새로운 주문이 들어오면 목록 상단에 추가됨

### 5.7 UI/UX 요구사항

#### 5.7.1 디자인 스타일
- 전체적으로 깔끔하고 미니멀한 디자인
- 배경: 흰색
- 섹션 컨테이너: 연한 회색 배경, 둥근 모서리
- 텍스트: 진한 회색
- 강조 색상: 다크 그린 (로고에 사용)
- 버튼: 회색 배경 또는 테두리

#### 5.7.2 사용자 경험
- 직관적인 인터페이스로 관리자가 쉽게 주문과 재고를 관리할 수 있어야 함
- 주문 상태 변경이 즉시 반영되어야 함
- 재고 조정이 즉시 반영되어야 함
- 통계 정보가 실시간으로 업데이트되어야 함
- 버튼 클릭 시 명확한 피드백 제공
- 중요한 작업(재고 감소, 주문 상태 변경) 시 확인 메시지 표시 (선택 사항)

#### 5.7.3 반응형 디자인
- 다양한 화면 크기에 대응 가능한 반응형 레이아웃
- 모바일, 태블릿, 데스크톱 환경 모두 지원
- 재고 카드와 주문 목록이 화면 크기에 따라 적절히 배치됨

### 5.8 데이터 요구사항

#### 5.8.1 주문 데이터 구조
각 주문은 다음 정보를 포함해야 합니다:
- 주문 ID
- 주문 시간 (타임스탬프)
- 주문 상태 (주문 접수 대기, 주문 접수, 제조 중, 제조 완료)
- 주문 아이템 목록:
  - 메뉴 ID
  - 메뉴 이름
  - 선택한 옵션 목록
  - 수량
  - 단가
  - 총 가격
- 총 주문 금액

#### 5.8.2 재고 데이터 구조
각 메뉴의 재고는 다음 정보를 포함해야 합니다:
- 메뉴 ID
- 메뉴 이름
- 현재 재고 수량
- 최소 재고 수량 (선택 사항)
- 최대 재고 수량 (선택 사항)

#### 5.8.3 주문 통계 데이터
주문 통계는 다음 정보를 포함해야 합니다:
- 총 주문 수 (모든 상태의 주문 포함)
- 주문 접수 수 (주문 접수 상태인 주문 수)
- 제조 중 수 (제조 중 상태인 주문 수)
- 제조 완료 수 (제조 완료 상태인 주문 수)

### 5.9 비즈니스 로직

#### 5.9.1 주문 상태 흐름
주문은 다음 순서로 상태가 변경됩니다:
1. **주문 접수 대기** → 사용자가 주문을 제출한 직후 상태
2. **주문 접수** → 관리자가 "주문 접수" 버튼을 클릭한 상태
3. **제조 중** → 관리자가 "제조 중" 버튼을 클릭한 상태
4. **제조 완료** → 관리자가 "제조 완료" 버튼을 클릭한 상태

#### 5.9.2 재고 관리 규칙
- 재고는 0 이상의 정수 값만 허용
- 재고 감소 시 0 이하로 내려가지 않도록 제한 (선택 사항)
- 주문 접수 시 해당 메뉴의 재고가 자동으로 차감됨 (선택 사항)
- 재고가 부족한 경우 주문 접수 불가 (선택 사항)

## 6. 백엔드 개발 (Backend Development)

### 6.1 데이터 모델 (Data Models)

#### 6.1.1 Menus (메뉴)
메뉴 테이블은 커피 메뉴의 기본 정보를 저장합니다.

**필드:**
- `id` (INTEGER, PRIMARY KEY, AUTO INCREMENT): 메뉴 고유 ID
- `name` (VARCHAR, NOT NULL): 커피 메뉴 이름
  - 예시: "아메리카노(ICE)", "아메리카노(HOT)", "카페라떼"
- `description` (TEXT): 메뉴에 대한 설명
  - 예시: "시원한 아이스 아메리카노", "부드러운 우유와 에스프레소의 조화"
- `price` (INTEGER, NOT NULL): 기본 가격 (원 단위)
  - 예시: 4000, 5000
- `image_url` (VARCHAR): 메뉴 이미지 URL (선택 사항)
- `stock` (INTEGER, NOT NULL, DEFAULT 0): 재고 수량
  - 관리자 화면에서 표시 및 관리
  - 주문 접수 시 자동 차감

**제약 조건:**
- `price`는 0 이상의 정수
- `stock`은 0 이상의 정수

#### 6.1.2 Options (옵션)
옵션 테이블은 메뉴에 추가할 수 있는 커스터마이징 옵션을 저장합니다.

**필드:**
- `id` (INTEGER, PRIMARY KEY, AUTO INCREMENT): 옵션 고유 ID
- `name` (VARCHAR, NOT NULL): 옵션 이름
  - 예시: "샷 추가", "시럽 추가"
- `price` (INTEGER, NOT NULL, DEFAULT 0): 옵션 추가 가격 (원 단위)
  - 예시: 500, 0
- `menu_id` (INTEGER, FOREIGN KEY): 연결된 메뉴 ID
  - Menus 테이블의 id를 참조
  - 여러 메뉴에 동일한 옵션을 사용할 수 있도록 설계

**제약 조건:**
- `price`는 0 이상의 정수
- `menu_id`는 Menus 테이블에 존재하는 ID여야 함

#### 6.1.3 Orders (주문)
주문 테이블은 사용자의 주문 정보를 저장합니다.

**필드:**
- `id` (INTEGER, PRIMARY KEY, AUTO INCREMENT): 주문 고유 ID
- `order_time` (TIMESTAMP, NOT NULL, DEFAULT CURRENT_TIMESTAMP): 주문 일시
  - 주문이 생성된 시간
  - 형식: "YYYY-MM-DD HH:MM:SS"
- `status` (VARCHAR, NOT NULL, DEFAULT 'received'): 주문 상태
  - 가능한 값: 'received' (주문 접수), 'preparing' (제조 중), 'completed' (제조 완료)
  - 기본값: 'received'
- `total_amount` (INTEGER, NOT NULL): 총 주문 금액 (원 단위)
  - 주문에 포함된 모든 아이템의 총 가격

**제약 조건:**
- `status`는 'received', 'preparing', 'completed' 중 하나여야 함
- `total_amount`는 0 이상의 정수

#### 6.1.4 OrderItems (주문 아이템)
주문 아이템 테이블은 주문에 포함된 각 메뉴 아이템의 상세 정보를 저장합니다.

**필드:**
- `id` (INTEGER, PRIMARY KEY, AUTO INCREMENT): 주문 아이템 고유 ID
- `order_id` (INTEGER, FOREIGN KEY, NOT NULL): 주문 ID
  - Orders 테이블의 id를 참조
- `menu_id` (INTEGER, FOREIGN KEY, NOT NULL): 메뉴 ID
  - Menus 테이블의 id를 참조
- `menu_name` (VARCHAR, NOT NULL): 메뉴 이름 (스냅샷)
  - 주문 시점의 메뉴 이름을 저장 (메뉴 이름이 변경되어도 주문 정보 유지)
- `quantity` (INTEGER, NOT NULL): 주문 수량
- `unit_price` (INTEGER, NOT NULL): 단가 (기본 가격 + 옵션 추가 가격)
- `total_price` (INTEGER, NOT NULL): 총 가격 (단가 × 수량)

**제약 조건:**
- `quantity`는 1 이상의 정수
- `unit_price`와 `total_price`는 0 이상의 정수

#### 6.1.5 OrderItemOptions (주문 아이템 옵션)
주문 아이템 옵션 테이블은 주문 아이템에 선택된 옵션 정보를 저장합니다.

**필드:**
- `id` (INTEGER, PRIMARY KEY, AUTO INCREMENT): 주문 아이템 옵션 고유 ID
- `order_item_id` (INTEGER, FOREIGN KEY, NOT NULL): 주문 아이템 ID
  - OrderItems 테이블의 id를 참조
- `option_id` (INTEGER, FOREIGN KEY, NOT NULL): 옵션 ID
  - Options 테이블의 id를 참조
- `option_name` (VARCHAR, NOT NULL): 옵션 이름 (스냅샷)
  - 주문 시점의 옵션 이름을 저장
- `option_price` (INTEGER, NOT NULL): 옵션 가격 (스냅샷)
  - 주문 시점의 옵션 가격을 저장

**제약 조건:**
- `option_price`는 0 이상의 정수

### 6.2 데이터 스키마를 위한 사용자 흐름

#### 6.2.1 메뉴 조회 및 표시
**흐름:**
1. 사용자가 '주문하기' 화면에 접속
2. 프런트엔드가 백엔드 API를 호출하여 Menus 테이블에서 메뉴 목록 조회
3. 각 메뉴에 연결된 Options 테이블에서 옵션 목록 조회
4. 조회된 메뉴와 옵션 정보를 브라우저 화면에 표시
5. 관리자 화면에서는 Menus 테이블의 `stock` 필드를 조회하여 재고 현황에 표시

**데이터 흐름:**
- Menus 테이블 → API 응답 → 프런트엔드 메뉴 카드 표시
- Options 테이블 → API 응답 → 프런트엔드 옵션 체크박스 표시
- Menus 테이블의 `stock` → API 응답 → 관리자 화면 재고 현황 표시

#### 6.2.2 장바구니 관리
**흐름:**
1. 사용자가 메뉴 카드에서 옵션을 선택하고 '담기' 버튼 클릭
2. 프런트엔드에서 선택한 메뉴와 옵션 정보를 장바구니 상태에 저장 (클라이언트 측)
3. 장바구니 영역에 선택한 메뉴, 옵션, 수량, 가격 표시
4. 같은 메뉴와 옵션 조합을 다시 담으면 수량 증가

**데이터 흐름:**
- 클라이언트 측 상태 관리 (서버 통신 없음)
- 장바구니 정보는 주문 전까지 클라이언트에만 저장

#### 6.2.3 주문 생성
**흐름:**
1. 사용자가 장바구니에서 '주문하기' 버튼 클릭
2. 프런트엔드에서 주문 정보를 백엔드 API로 전송
3. 백엔드에서 다음 작업 수행:
   - Orders 테이블에 주문 레코드 생성 (`order_time`, `status`, `total_amount`)
   - OrderItems 테이블에 주문 아이템 레코드 생성 (각 메뉴별로)
   - OrderItemOptions 테이블에 선택된 옵션 레코드 생성 (각 옵션별로)
4. 생성된 주문 ID를 프런트엔드에 반환
5. 프런트엔드에서 주문 완료 알림 표시 및 장바구니 초기화

**데이터 흐름:**
- 장바구니 데이터 → API 요청 → Orders 테이블 저장
- 주문 아이템 데이터 → API 요청 → OrderItems 테이블 저장
- 옵션 데이터 → API 요청 → OrderItemOptions 테이블 저장

#### 6.2.4 주문 현황 조회 및 상태 변경
**흐름:**
1. 관리자가 관리자 화면의 '주문 현황' 섹션에 접속
2. 프런트엔드가 백엔드 API를 호출하여 Orders 테이블에서 주문 목록 조회
3. 각 주문에 대한 OrderItems와 OrderItemOptions 정보도 함께 조회
4. 조회된 주문 정보를 관리자 화면에 표시
5. 관리자가 '제조 시작' 버튼 클릭 시:
   - 주문 상태를 'preparing'으로 변경
   - 해당 주문의 OrderItems를 조회하여 각 메뉴의 수량 확인
   - Menus 테이블에서 해당 메뉴의 재고를 차감
6. 관리자가 '제조 완료' 버튼 클릭 시:
   - 주문 상태를 'completed'로 변경

**데이터 흐름:**
- Orders 테이블 → API 응답 → 관리자 화면 주문 목록 표시
- 주문 상태 변경 요청 → Orders 테이블 업데이트
- 주문 상태 변경 시 → Menus 테이블의 `stock` 필드 업데이트 (재고 차감)

### 6.3 API 설계

#### 6.3.1 메뉴 목록 조회
**엔드포인트:** `GET /api/menus`

**설명:**
- 주문하기 화면에서 커피 메뉴 목록을 조회하는 API
- Menus 테이블과 Options 테이블을 조인하여 각 메뉴에 대한 옵션 정보도 함께 반환

**요청:**
- 요청 본문: 없음
- 쿼리 파라미터: 없음

**응답:**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "name": "아메리카노(ICE)",
      "description": "시원한 아이스 아메리카노",
      "price": 4000,
      "image_url": "https://example.com/image.jpg",
      "stock": 10,
      "options": [
        {
          "id": 1,
          "name": "샷 추가",
          "price": 500
        },
        {
          "id": 2,
          "name": "시럽 추가",
          "price": 0
        }
      ]
    }
  ]
}
```

**에러 응답:**
```json
{
  "success": false,
  "error": "메뉴 조회 중 오류가 발생했습니다."
}
```

#### 6.3.2 주문 생성
**엔드포인트:** `POST /api/orders`

**설명:**
- 사용자가 장바구니에서 '주문하기' 버튼을 클릭할 때 호출되는 API
- 주문 정보를 Orders, OrderItems, OrderItemOptions 테이블에 저장
- 주문 생성 후 주문 ID를 반환

**요청:**
```json
{
  "items": [
    {
      "menu_id": 1,
      "menu_name": "아메리카노(ICE)",
      "quantity": 2,
      "unit_price": 4500,
      "total_price": 9000,
      "options": [
        {
          "option_id": 1,
          "option_name": "샷 추가",
          "option_price": 500
        }
      ]
    },
    {
      "menu_id": 2,
      "menu_name": "아메리카노(HOT)",
      "quantity": 1,
      "unit_price": 4000,
      "total_price": 4000,
      "options": []
    }
  ],
  "total_amount": 13000
}
```

**응답:**
```json
{
  "success": true,
  "data": {
    "order_id": 123,
    "order_time": "2024-07-31T13:00:00Z",
    "status": "received",
    "total_amount": 13000
  }
}
```

**에러 응답:**
```json
{
  "success": false,
  "error": "주문 생성 중 오류가 발생했습니다."
}
```

#### 6.3.3 주문 목록 조회
**엔드포인트:** `GET /api/orders`

**설명:**
- 관리자 화면의 '주문 현황' 섹션에서 주문 목록을 조회하는 API
- Orders, OrderItems, OrderItemOptions 테이블을 조인하여 완전한 주문 정보 반환
- 주문 상태별 필터링 가능

**요청:**
- 요청 본문: 없음
- 쿼리 파라미터:
  - `status` (선택): 주문 상태 필터 ('received', 'preparing', 'completed')
  - `limit` (선택): 조회할 주문 개수 제한
  - `offset` (선택): 페이지네이션을 위한 오프셋

**응답:**
```json
{
  "success": true,
  "data": [
    {
      "id": 123,
      "order_time": "2024-07-31T13:00:00Z",
      "status": "received",
      "total_amount": 13000,
      "items": [
        {
          "id": 1,
          "menu_id": 1,
          "menu_name": "아메리카노(ICE)",
          "quantity": 2,
          "unit_price": 4500,
          "total_price": 9000,
          "options": [
            {
              "id": 1,
              "option_id": 1,
              "option_name": "샷 추가",
              "option_price": 500
            }
          ]
        },
        {
          "id": 2,
          "menu_id": 2,
          "menu_name": "아메리카노(HOT)",
          "quantity": 1,
          "unit_price": 4000,
          "total_price": 4000,
          "options": []
        }
      ]
    }
  ]
}
```

#### 6.3.4 주문 상세 조회
**엔드포인트:** `GET /api/orders/:orderId`

**설명:**
- 주문 ID를 전달하면 해당 주문의 상세 정보를 반환하는 API
- Orders, OrderItems, OrderItemOptions 테이블을 조인하여 완전한 주문 정보 반환

**요청:**
- 경로 파라미터:
  - `orderId` (필수): 조회할 주문 ID

**응답:**
```json
{
  "success": true,
  "data": {
    "id": 123,
    "order_time": "2024-07-31T13:00:00Z",
    "status": "received",
    "total_amount": 13000,
    "items": [
      {
        "id": 1,
        "menu_id": 1,
        "menu_name": "아메리카노(ICE)",
        "quantity": 2,
        "unit_price": 4500,
        "total_price": 9000,
        "options": [
          {
            "id": 1,
            "option_id": 1,
            "option_name": "샷 추가",
            "option_price": 500
          }
        ]
      }
    ]
  }
}
```

**에러 응답:**
```json
{
  "success": false,
  "error": "주문을 찾을 수 없습니다."
}
```

#### 6.3.5 주문 상태 변경
**엔드포인트:** `PATCH /api/orders/:orderId/status`

**설명:**
- 관리자가 주문 상태를 변경할 때 호출되는 API
- 주문 상태를 'received' → 'preparing' → 'completed'로 변경
- 상태가 'preparing'으로 변경될 때 해당 주문의 메뉴 재고를 자동 차감

**요청:**
- 경로 파라미터:
  - `orderId` (필수): 상태를 변경할 주문 ID
- 요청 본문:
```json
{
  "status": "preparing"
}
```

**응답:**
```json
{
  "success": true,
  "data": {
    "order_id": 123,
    "status": "preparing",
    "updated_at": "2024-07-31T13:05:00Z"
  }
}
```

**에러 응답:**
```json
{
  "success": false,
  "error": "주문 상태 변경 중 오류가 발생했습니다."
}
```

**비즈니스 로직:**
- 상태가 'preparing'으로 변경될 때:
  1. 해당 주문의 OrderItems를 조회
  2. 각 OrderItem의 `menu_id`와 `quantity`를 확인
  3. Menus 테이블에서 해당 메뉴의 `stock`을 차감
  4. 재고가 부족한 경우 에러 반환 (선택 사항)

#### 6.3.6 재고 조회
**엔드포인트:** `GET /api/menus/inventory`

**설명:**
- 관리자 화면의 '재고 현황' 섹션에서 메뉴별 재고를 조회하는 API
- Menus 테이블에서 메뉴 ID, 이름, 재고 수량을 반환

**요청:**
- 요청 본문: 없음
- 쿼리 파라미터: 없음

**응답:**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "name": "아메리카노 (ICE)",
      "stock": 10
    },
    {
      "id": 2,
      "name": "아메리카노 (HOT)",
      "stock": 8
    },
    {
      "id": 3,
      "name": "카페라떼",
      "stock": 5
    }
  ]
}
```

#### 6.3.7 재고 수정
**엔드포인트:** `PATCH /api/menus/:menuId/inventory`

**설명:**
- 관리자가 재고 현황에서 +/- 버튼을 클릭할 때 호출되는 API
- 특정 메뉴의 재고를 증가 또는 감소시킴

**요청:**
- 경로 파라미터:
  - `menuId` (필수): 재고를 수정할 메뉴 ID
- 요청 본문:
```json
{
  "change": 1
}
```
- `change`: 재고 변경량 (양수: 증가, 음수: 감소)

**응답:**
```json
{
  "success": true,
  "data": {
    "menu_id": 1,
    "name": "아메리카노 (ICE)",
    "stock": 11,
    "updated_at": "2024-07-31T13:10:00Z"
  }
}
```

**에러 응답:**
```json
{
  "success": false,
  "error": "재고는 0 이하로 내려갈 수 없습니다."
}
```

**제약 조건:**
- 재고는 0 이하로 내려갈 수 없음
- 재고 변경 후 Menus 테이블의 `stock` 필드 업데이트

### 6.4 API 공통 사항

#### 6.4.1 응답 형식
모든 API는 다음 형식을 따릅니다:
- 성공 시: `{ "success": true, "data": ... }`
- 실패 시: `{ "success": false, "error": "에러 메시지" }`

#### 6.4.2 HTTP 상태 코드
- `200 OK`: 요청 성공
- `201 Created`: 리소스 생성 성공 (POST)
- `400 Bad Request`: 잘못된 요청
- `404 Not Found`: 리소스를 찾을 수 없음
- `500 Internal Server Error`: 서버 오류

#### 6.4.3 에러 처리
- 데이터베이스 오류, 유효성 검사 실패 등 모든 에러는 적절한 HTTP 상태 코드와 함께 에러 메시지를 반환
- 클라이언트는 에러 응답을 받아 사용자에게 적절한 메시지 표시

#### 6.4.4 데이터베이스 트랜잭션
- 주문 생성 시 Orders, OrderItems, OrderItemOptions 테이블에 데이터를 저장하는 작업은 트랜잭션으로 처리
- 주문 상태 변경 시 Orders 테이블 업데이트와 Menus 테이블 재고 차감은 트랜잭션으로 처리
- 트랜잭션 중 오류 발생 시 모든 변경 사항 롤백